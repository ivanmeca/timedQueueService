package data_types

import (
	"encoding/json"
	"fmt"
	. "github.com/onsi/gomega"
	"testing"
)

func TestEventEntry(test *testing.T) {
	RegisterTestingT(test)
	fmt.Println("Trying to generate a event entry")
	event, err := NewCloudEventV02(ApplicationJson, "Teste", nil)
	Expect(err).ShouldNot(HaveOccurred())
	fmt.Println(event.String())

}

func TestEventEntryWithExtensions(test *testing.T) {
	RegisterTestingT(test)
	fmt.Println("Trying to generate a event entry with extensions")
	event, err := NewCloudEventV02(ApplicationJson, `{"errorQueue":"Error.Timer.Resource.Scheduled","retry":3,"type":"timer","referenceName":"Timer.Resource.ThrowAt","message":{"referenceName":"Timer.Resource.ThrowAt","origin":[],"data":{"eventDate":{"date":"2019-05-13 19:20:04.000000","timezone_type":3,"timezone":"UTC"},"event":{"referenceName":"Native.Location.Expire","origin":[],"data":{"eventDate":{"date":"2019-05-13 19:20:13.000000","timezone_type":3,"timezone":"UTC"},"location":{"latitude":-24.812354,"longitude":-13.251654,"velocity":null,"precision":null,"direction":null,"address":null,"creationDate":{"date":"2019-05-13 19:20:03.000000","timezone_type":3,"timezone":"UTC"},"locationDate":{"date":"2019-05-13 19:20:08.000000","timezone_type":3,"timezone":"UTC"},"timeLapse":null,"precisionQualifier":null,"reason":null,"source":"RadioGateway","rejected":false,"rejectedReason":null,"driver":null,"odometer":null,"horimetre":null,"batteryLevel":null},"user":{"userId":1,"name":"TestUser 1","active":true,"userType":{"userTypeId":1,"name":"TestUserType 1","statusSet":{"statusSetId":1,"name":"Set 1","defaultDescription":"Set 1","defaultMapImage":"\/file\/fcef71cb","inactiveMapImage":"\/file\/f2a5ce77","unknownMapImage":"\/file\/331f50e4","unknownTimeToLive":1,"hasUnknownAlarm":false,"hasInactiveAlarm":false,"unknownAlarmMessage":"","inactiveAlarmMessage":"","generateUnknownStatus":true,"statusOverflow":null,"statusSetItemCollection":[{"statusSetItemId":1,"code":32768,"description":"Status 0","image":"\/file\/3be52bd8","timeToLive":null,"hasAlarm":false,"alarmMessage":null,"statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":2,"code":32769,"description":"Status 1","image":"\/file\/3c246e41","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":1,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":3,"code":32770,"description":"Status 2","image":"\/file\/3e32ef25","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":2,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":4,"code":32771,"description":"Status 3","image":"\/file\/3fa4b22c","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":3,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":5,"code":32772,"description":"Status 4","image":"\/file\/4aacc9df","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":4,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":6,"code":32773,"description":"Status 5","image":"\/file\/4af0a333","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":5,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":7,"code":32774,"description":"Status 6","image":"\/file\/4c6e8bdb","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":8,"code":32775,"description":"Status 7","image":"\/file\/4d6d0de8","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":9,"code":32776,"description":"Status 8","image":"\/file\/4f82ae0c","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":8,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":20,"code":32777,"description":"Status 9","image":"\/file\/8c28de6c","timeToLive":null,"hasAlarm":true,"alarmMessage":"5000","statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":21,"code":32778,"description":"Status 10","image":"\/file\/8c35deeb","timeToLive":null,"hasAlarm":false,"alarmMessage":"5000","statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":22,"code":32779,"description":"Status 11","image":"\/file\/10c1f975","timeToLive":null,"hasAlarm":true,"alarmMessage":"","statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":23,"code":32780,"description":"Status 12","image":"\/file\/13efb338","timeToLive":null,"hasAlarm":true,"alarmMessage":"g76y7u","statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":24,"code":32781,"description":"Status 13","image":"\/file\/28b65af2","timeToLive":null,"hasAlarm":false,"alarmMessage":"","statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":25,"code":32782,"description":"Status 14","image":"\/file\/28deb28b","timeToLive":null,"hasAlarm":false,"alarmMessage":"g76y7u","statusOverflow":null,"generateSameStatus":true,"hasEvent":true}]}},"observation":""},"device":{"deviceId":"5000","deviceUniqueId":8,"system":{"systemId":2,"description":"SystemTest","code":"724-1121","systemType":{"systemTypeId":2,"description":"SystemTypeTest","code":"Tetra"}}},"contract":{"contractId":1,"contractCode":"0000\/0000","contractEmail":"test@email.com","enterprise":{"enterpriseId":1,"enterpriseDescription":"Tester Enterprise","enterpriseCode":"000000","enterpriseIdentification":"00000000000000"}},"expirationDate":{"date":"2019-05-13 19:20:13.000000","timezone_type":3,"timezone":"UTC"},"version":3},"context":[]},"reference":"Native.Location.Expire","throwAt":1557775213,"throwInMilliseconds":1000,"iterations":8,"maxTimeWait":1000},"context":[]}}`, map[string]interface{}{"DestPath": "teste"})
	Expect(err).ShouldNot(HaveOccurred())
	fmt.Println("Evento", event.String())
}

func TestEventBasicMarshal(test *testing.T) {
	RegisterTestingT(test)
	fmt.Println("Trying to marshalJSON a event entry")
	event, err := NewCloudEventV02(ApplicationJson, `Teste`, map[string]interface{}{"DestPath": "teste"})
	data, err := json.Marshal(event)
	Expect(err).ShouldNot(HaveOccurred())
	fmt.Println(string(data))
	Expect(data).ShouldNot(BeEquivalentTo(`{"Context":{"specversion":"0.2","type":"application/json","source":"TimedEventApi","id":"b18bfd05-7672-11e9-b0b8-54bf64f7912d","time":"2019-05-14T18:04:18.860168123Z","-":{"DestPath":"teste"}},"Data":"","DataEncoded":true}`))
}

func TestEventMarshal(test *testing.T) {
	RegisterTestingT(test)
	fmt.Println("Trying to marshalJSON a event entry")
	event, err := NewCloudEventV02(ApplicationJson, `{"errorQueue":"Error.Timer.Resource.Scheduled","retry":3,"type":"timer","referenceName":"Timer.Resource.ThrowAt","message":{"referenceName":"Timer.Resource.ThrowAt","origin":[],"data":{"eventDate":{"date":"2019-05-13 19:20:04.000000","timezone_type":3,"timezone":"UTC"},"event":{"referenceName":"Native.Location.Expire","origin":[],"data":{"eventDate":{"date":"2019-05-13 19:20:13.000000","timezone_type":3,"timezone":"UTC"},"location":{"latitude":-24.812354,"longitude":-13.251654,"velocity":null,"precision":null,"direction":null,"address":null,"creationDate":{"date":"2019-05-13 19:20:03.000000","timezone_type":3,"timezone":"UTC"},"locationDate":{"date":"2019-05-13 19:20:08.000000","timezone_type":3,"timezone":"UTC"},"timeLapse":null,"precisionQualifier":null,"reason":null,"source":"RadioGateway","rejected":false,"rejectedReason":null,"driver":null,"odometer":null,"horimetre":null,"batteryLevel":null},"user":{"userId":1,"name":"TestUser 1","active":true,"userType":{"userTypeId":1,"name":"TestUserType 1","statusSet":{"statusSetId":1,"name":"Set 1","defaultDescription":"Set 1","defaultMapImage":"\/file\/fcef71cb","inactiveMapImage":"\/file\/f2a5ce77","unknownMapImage":"\/file\/331f50e4","unknownTimeToLive":1,"hasUnknownAlarm":false,"hasInactiveAlarm":false,"unknownAlarmMessage":"","inactiveAlarmMessage":"","generateUnknownStatus":true,"statusOverflow":null,"statusSetItemCollection":[{"statusSetItemId":1,"code":32768,"description":"Status 0","image":"\/file\/3be52bd8","timeToLive":null,"hasAlarm":false,"alarmMessage":null,"statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":2,"code":32769,"description":"Status 1","image":"\/file\/3c246e41","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":1,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":3,"code":32770,"description":"Status 2","image":"\/file\/3e32ef25","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":2,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":4,"code":32771,"description":"Status 3","image":"\/file\/3fa4b22c","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":3,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":5,"code":32772,"description":"Status 4","image":"\/file\/4aacc9df","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":4,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":6,"code":32773,"description":"Status 5","image":"\/file\/4af0a333","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":5,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":7,"code":32774,"description":"Status 6","image":"\/file\/4c6e8bdb","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":8,"code":32775,"description":"Status 7","image":"\/file\/4d6d0de8","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":9,"code":32776,"description":"Status 8","image":"\/file\/4f82ae0c","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":8,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":20,"code":32777,"description":"Status 9","image":"\/file\/8c28de6c","timeToLive":null,"hasAlarm":true,"alarmMessage":"5000","statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":21,"code":32778,"description":"Status 10","image":"\/file\/8c35deeb","timeToLive":null,"hasAlarm":false,"alarmMessage":"5000","statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":22,"code":32779,"description":"Status 11","image":"\/file\/10c1f975","timeToLive":null,"hasAlarm":true,"alarmMessage":"","statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":23,"code":32780,"description":"Status 12","image":"\/file\/13efb338","timeToLive":null,"hasAlarm":true,"alarmMessage":"g76y7u","statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":24,"code":32781,"description":"Status 13","image":"\/file\/28b65af2","timeToLive":null,"hasAlarm":false,"alarmMessage":"","statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":25,"code":32782,"description":"Status 14","image":"\/file\/28deb28b","timeToLive":null,"hasAlarm":false,"alarmMessage":"g76y7u","statusOverflow":null,"generateSameStatus":true,"hasEvent":true}]}},"observation":""},"device":{"deviceId":"5000","deviceUniqueId":8,"system":{"systemId":2,"description":"SystemTest","code":"724-1121","systemType":{"systemTypeId":2,"description":"SystemTypeTest","code":"Tetra"}}},"contract":{"contractId":1,"contractCode":"0000\/0000","contractEmail":"test@email.com","enterprise":{"enterpriseId":1,"enterpriseDescription":"Tester Enterprise","enterpriseCode":"000000","enterpriseIdentification":"00000000000000"}},"expirationDate":{"date":"2019-05-13 19:20:13.000000","timezone_type":3,"timezone":"UTC"},"version":3},"context":[]},"reference":"Native.Location.Expire","throwAt":1557775213,"throwInMilliseconds":1000,"iterations":8,"maxTimeWait":1000},"context":[]}}`, map[string]interface{}{"DestPath": "teste"})
	data, err := json.Marshal(event)
	Expect(err).ShouldNot(HaveOccurred())
	fmt.Println(string(data))
	Expect(data).ShouldNot(BeEquivalentTo(`{"Context":{"specversion":"0.2","type":"application/json","source":"TimedEventApi","id":"b18bfd05-7672-11e9-b0b8-54bf64f7912d","time":"2019-05-14T18:04:18.860168123Z","-":{"DestPath":"teste"}},"Data":"eyJlcnJvclF1ZXVlIjoiRXJyb3IuVGltZXIuUmVzb3VyY2UuU2NoZWR1bGVkIiwicmV0cnkiOjMsInR5cGUiOiJ0aW1lciIsInJlZmVyZW5jZU5hbWUiOiJUaW1lci5SZXNvdXJjZS5UaHJvd0F0IiwibWVzc2FnZSI6eyJyZWZlcmVuY2VOYW1lIjoiVGltZXIuUmVzb3VyY2UuVGhyb3dBdCIsIm9yaWdpbiI6W10sImRhdGEiOnsiZXZlbnREYXRlIjp7ImRhdGUiOiIyMDE5LTA1LTEzIDE5OjIwOjA0LjAwMDAwMCIsInRpbWV6b25lX3R5cGUiOjMsInRpbWV6b25lIjoiVVRDIn0sImV2ZW50Ijp7InJlZmVyZW5jZU5hbWUiOiJOYXRpdmUuTG9jYXRpb24uRXhwaXJlIiwib3JpZ2luIjpbXSwiZGF0YSI6eyJldmVudERhdGUiOnsiZGF0ZSI6IjIwMTktMDUtMTMgMTk6MjA6MTMuMDAwMDAwIiwidGltZXpvbmVfdHlwZSI6MywidGltZXpvbmUiOiJVVEMifSwibG9jYXRpb24iOnsibGF0aXR1ZGUiOi0yNC44MTIzNTQsImxvbmdpdHVkZSI6LTEzLjI1MTY1NCwidmVsb2NpdHkiOm51bGwsInByZWNpc2lvbiI6bnVsbCwiZGlyZWN0aW9uIjpudWxsLCJhZGRyZXNzIjpudWxsLCJjcmVhdGlvbkRhdGUiOnsiZGF0ZSI6IjIwMTktMDUtMTMgMTk6MjA6MDMuMDAwMDAwIiwidGltZXpvbmVfdHlwZSI6MywidGltZXpvbmUiOiJVVEMifSwibG9jYXRpb25EYXRlIjp7ImRhdGUiOiIyMDE5LTA1LTEzIDE5OjIwOjA4LjAwMDAwMCIsInRpbWV6b25lX3R5cGUiOjMsInRpbWV6b25lIjoiVVRDIn0sInRpbWVMYXBzZSI6bnVsbCwicHJlY2lzaW9uUXVhbGlmaWVyIjpudWxsLCJyZWFzb24iOm51bGwsInNvdXJjZSI6IlJhZGlvR2F0ZXdheSIsInJlamVjdGVkIjpmYWxzZSwicmVqZWN0ZWRSZWFzb24iOm51bGwsImRyaXZlciI6bnVsbCwib2RvbWV0ZXIiOm51bGwsImhvcmltZXRyZSI6bnVsbCwiYmF0dGVyeUxldmVsIjpudWxsfSwidXNlciI6eyJ1c2VySWQiOjEsIm5hbWUiOiJUZXN0VXNlciAxIiwiYWN0aXZlIjp0cnVlLCJ1c2VyVHlwZSI6eyJ1c2VyVHlwZUlkIjoxLCJuYW1lIjoiVGVzdFVzZXJUeXBlIDEiLCJzdGF0dXNTZXQiOnsic3RhdHVzU2V0SWQiOjEsIm5hbWUiOiJTZXQgMSIsImRlZmF1bHREZXNjcmlwdGlvbiI6IlNldCAxIiwiZGVmYXVsdE1hcEltYWdlIjoiXC9maWxlXC9mY2VmNzFjYiIsImluYWN0aXZlTWFwSW1hZ2UiOiJcL2ZpbGVcL2YyYTVjZTc3IiwidW5rbm93bk1hcEltYWdlIjoiXC9maWxlXC8zMzFmNTBlNCIsInVua25vd25UaW1lVG9MaXZlIjoxLCJoYXNVbmtub3duQWxhcm0iOmZhbHNlLCJoYXNJbmFjdGl2ZUFsYXJtIjpmYWxzZSwidW5rbm93bkFsYXJtTWVzc2FnZSI6IiIsImluYWN0aXZlQWxhcm1NZXNzYWdlIjoiIiwiZ2VuZXJhdGVVbmtub3duU3RhdHVzIjp0cnVlLCJzdGF0dXNPdmVyZmxvdyI6bnVsbCwic3RhdHVzU2V0SXRlbUNvbGxlY3Rpb24iOlt7InN0YXR1c1NldEl0ZW1JZCI6MSwiY29kZSI6MzI3NjgsImRlc2NyaXB0aW9uIjoiU3RhdHVzIDAiLCJpbWFnZSI6IlwvZmlsZVwvM2JlNTJiZDgiLCJ0aW1lVG9MaXZlIjpudWxsLCJoYXNBbGFybSI6ZmFsc2UsImFsYXJtTWVzc2FnZSI6bnVsbCwic3RhdHVzT3ZlcmZsb3ciOm51bGwsImdlbmVyYXRlU2FtZVN0YXR1cyI6dHJ1ZSwiaGFzRXZlbnQiOmZhbHNlfSx7InN0YXR1c1NldEl0ZW1JZCI6MiwiY29kZSI6MzI3NjksImRlc2NyaXB0aW9uIjoiU3RhdHVzIDEiLCJpbWFnZSI6IlwvZmlsZVwvM2MyNDZlNDEiLCJ0aW1lVG9MaXZlIjoxLCJoYXNBbGFybSI6ZmFsc2UsImFsYXJtTWVzc2FnZSI6bnVsbCwic3RhdHVzT3ZlcmZsb3ciOjEsImdlbmVyYXRlU2FtZVN0YXR1cyI6dHJ1ZSwiaGFzRXZlbnQiOmZhbHNlfSx7InN0YXR1c1NldEl0ZW1JZCI6MywiY29kZSI6MzI3NzAsImRlc2NyaXB0aW9uIjoiU3RhdHVzIDIiLCJpbWFnZSI6IlwvZmlsZVwvM2UzMmVmMjUiLCJ0aW1lVG9MaXZlIjoxLCJoYXNBbGFybSI6ZmFsc2UsImFsYXJtTWVzc2FnZSI6bnVsbCwic3RhdHVzT3ZlcmZsb3ciOjIsImdlbmVyYXRlU2FtZVN0YXR1cyI6dHJ1ZSwiaGFzRXZlbnQiOmZhbHNlfSx7InN0YXR1c1NldEl0ZW1JZCI6NCwiY29kZSI6MzI3NzEsImRlc2NyaXB0aW9uIjoiU3RhdHVzIDMiLCJpbWFnZSI6IlwvZmlsZVwvM2ZhNGIyMmMiLCJ0aW1lVG9MaXZlIjoxLCJoYXNBbGFybSI6ZmFsc2UsImFsYXJtTWVzc2FnZSI6bnVsbCwic3RhdHVzT3ZlcmZsb3ciOjMsImdlbmVyYXRlU2FtZVN0YXR1cyI6dHJ1ZSwiaGFzRXZlbnQiOmZhbHNlfSx7InN0YXR1c1NldEl0ZW1JZCI6NSwiY29kZSI6MzI3NzIsImRlc2NyaXB0aW9uIjoiU3RhdHVzIDQiLCJpbWFnZSI6IlwvZmlsZVwvNGFhY2M5ZGYiLCJ0aW1lVG9MaXZlIjoxLCJoYXNBbGFybSI6ZmFsc2UsImFsYXJtTWVzc2FnZSI6bnVsbCwic3RhdHVzT3ZlcmZsb3ciOjQsImdlbmVyYXRlU2FtZVN0YXR1cyI6dHJ1ZSwiaGFzRXZlbnQiOmZhbHNlfSx7InN0YXR1c1NldEl0ZW1JZCI6NiwiY29kZSI6MzI3NzMsImRlc2NyaXB0aW9uIjoiU3RhdHVzIDUiLCJpbWFnZSI6IlwvZmlsZVwvNGFmMGEzMzMiLCJ0aW1lVG9MaXZlIjoxLCJoYXNBbGFybSI6ZmFsc2UsImFsYXJtTWVzc2FnZSI6bnVsbCwic3RhdHVzT3ZlcmZsb3ciOjUsImdlbmVyYXRlU2FtZVN0YXR1cyI6dHJ1ZSwiaGFzRXZlbnQiOmZhbHNlfSx7InN0YXR1c1NldEl0ZW1JZCI6NywiY29kZSI6MzI3NzQsImRlc2NyaXB0aW9uIjoiU3RhdHVzIDYiLCJpbWFnZSI6IlwvZmlsZVwvNGM2ZThiZGIiLCJ0aW1lVG9MaXZlIjoxLCJoYXNBbGFybSI6ZmFsc2UsImFsYXJtTWVzc2FnZSI6bnVsbCwic3RhdHVzT3ZlcmZsb3ciOm51bGwsImdlbmVyYXRlU2FtZVN0YXR1cyI6dHJ1ZSwiaGFzRXZlbnQiOmZhbHNlfSx7InN0YXR1c1NldEl0ZW1JZCI6OCwiY29kZSI6MzI3NzUsImRlc2NyaXB0aW9uIjoiU3RhdHVzIDciLCJpbWFnZSI6IlwvZmlsZVwvNGQ2ZDBkZTgiLCJ0aW1lVG9MaXZlIjoxLCJoYXNBbGFybSI6ZmFsc2UsImFsYXJtTWVzc2FnZSI6bnVsbCwic3RhdHVzT3ZlcmZsb3ciOm51bGwsImdlbmVyYXRlU2FtZVN0YXR1cyI6dHJ1ZSwiaGFzRXZlbnQiOmZhbHNlfSx7InN0YXR1c1NldEl0ZW1JZCI6OSwiY29kZSI6MzI3NzYsImRlc2NyaXB0aW9uIjoiU3RhdHVzIDgiLCJpbWFnZSI6IlwvZmlsZVwvNGY4MmFlMGMiLCJ0aW1lVG9MaXZlIjoxLCJoYXNBbGFybSI6ZmFsc2UsImFsYXJtTWVzc2FnZSI6bnVsbCwic3RhdHVzT3ZlcmZsb3ciOjgsImdlbmVyYXRlU2FtZVN0YXR1cyI6dHJ1ZSwiaGFzRXZlbnQiOmZhbHNlfSx7InN0YXR1c1NldEl0ZW1JZCI6MjAsImNvZGUiOjMyNzc3LCJkZXNjcmlwdGlvbiI6IlN0YXR1cyA5IiwiaW1hZ2UiOiJcL2ZpbGVcLzhjMjhkZTZjIiwidGltZVRvTGl2ZSI6bnVsbCwiaGFzQWxhcm0iOnRydWUsImFsYXJtTWVzc2FnZSI6IjUwMDAiLCJzdGF0dXNPdmVyZmxvdyI6bnVsbCwiZ2VuZXJhdGVTYW1lU3RhdHVzIjp0cnVlLCJoYXNFdmVudCI6ZmFsc2V9LHsic3RhdHVzU2V0SXRlbUlkIjoyMSwiY29kZSI6MzI3NzgsImRlc2NyaXB0aW9uIjoiU3RhdHVzIDEwIiwiaW1hZ2UiOiJcL2ZpbGVcLzhjMzVkZWViIiwidGltZVRvTGl2ZSI6bnVsbCwiaGFzQWxhcm0iOmZhbHNlLCJhbGFybU1lc3NhZ2UiOiI1MDAwIiwic3RhdHVzT3ZlcmZsb3ciOm51bGwsImdlbmVyYXRlU2FtZVN0YXR1cyI6dHJ1ZSwiaGFzRXZlbnQiOmZhbHNlfSx7InN0YXR1c1NldEl0ZW1JZCI6MjIsImNvZGUiOjMyNzc5LCJkZXNjcmlwdGlvbiI6IlN0YXR1cyAxMSIsImltYWdlIjoiXC9maWxlXC8xMGMxZjk3NSIsInRpbWVUb0xpdmUiOm51bGwsImhhc0FsYXJtIjp0cnVlLCJhbGFybU1lc3NhZ2UiOiIiLCJzdGF0dXNPdmVyZmxvdyI6bnVsbCwiZ2VuZXJhdGVTYW1lU3RhdHVzIjp0cnVlLCJoYXNFdmVudCI6ZmFsc2V9LHsic3RhdHVzU2V0SXRlbUlkIjoyMywiY29kZSI6MzI3ODAsImRlc2NyaXB0aW9uIjoiU3RhdHVzIDEyIiwiaW1hZ2UiOiJcL2ZpbGVcLzEzZWZiMzM4IiwidGltZVRvTGl2ZSI6bnVsbCwiaGFzQWxhcm0iOnRydWUsImFsYXJtTWVzc2FnZSI6Imc3Nnk3dSIsInN0YXR1c092ZXJmbG93IjpudWxsLCJnZW5lcmF0ZVNhbWVTdGF0dXMiOnRydWUsImhhc0V2ZW50IjpmYWxzZX0seyJzdGF0dXNTZXRJdGVtSWQiOjI0LCJjb2RlIjozMjc4MSwiZGVzY3JpcHRpb24iOiJTdGF0dXMgMTMiLCJpbWFnZSI6IlwvZmlsZVwvMjhiNjVhZjIiLCJ0aW1lVG9MaXZlIjpudWxsLCJoYXNBbGFybSI6ZmFsc2UsImFsYXJtTWVzc2FnZSI6IiIsInN0YXR1c092ZXJmbG93IjpudWxsLCJnZW5lcmF0ZVNhbWVTdGF0dXMiOnRydWUsImhhc0V2ZW50IjpmYWxzZX0seyJzdGF0dXNTZXRJdGVtSWQiOjI1LCJjb2RlIjozMjc4MiwiZGVzY3JpcHRpb24iOiJTdGF0dXMgMTQiLCJpbWFnZSI6IlwvZmlsZVwvMjhkZWIyOGIiLCJ0aW1lVG9MaXZlIjpudWxsLCJoYXNBbGFybSI6ZmFsc2UsImFsYXJtTWVzc2FnZSI6Imc3Nnk3dSIsInN0YXR1c092ZXJmbG93IjpudWxsLCJnZW5lcmF0ZVNhbWVTdGF0dXMiOnRydWUsImhhc0V2ZW50Ijp0cnVlfV19fSwib2JzZXJ2YXRpb24iOiIifSwiZGV2aWNlIjp7ImRldmljZUlkIjoiNTAwMCIsImRldmljZVVuaXF1ZUlkIjo4LCJzeXN0ZW0iOnsic3lzdGVtSWQiOjIsImRlc2NyaXB0aW9uIjoiU3lzdGVtVGVzdCIsImNvZGUiOiI3MjQtMTEyMSIsInN5c3RlbVR5cGUiOnsic3lzdGVtVHlwZUlkIjoyLCJkZXNjcmlwdGlvbiI6IlN5c3RlbVR5cGVUZXN0IiwiY29kZSI6IlRldHJhIn19fSwiY29udHJhY3QiOnsiY29udHJhY3RJZCI6MSwiY29udHJhY3RDb2RlIjoiMDAwMFwvMDAwMCIsImNvbnRyYWN0RW1haWwiOiJ0ZXN0QGVtYWlsLmNvbSIsImVudGVycHJpc2UiOnsiZW50ZXJwcmlzZUlkIjoxLCJlbnRlcnByaXNlRGVzY3JpcHRpb24iOiJUZXN0ZXIgRW50ZXJwcmlzZSIsImVudGVycHJpc2VDb2RlIjoiMDAwMDAwIiwiZW50ZXJwcmlzZUlkZW50aWZpY2F0aW9uIjoiMDAwMDAwMDAwMDAwMDAifX0sImV4cGlyYXRpb25EYXRlIjp7ImRhdGUiOiIyMDE5LTA1LTEzIDE5OjIwOjEzLjAwMDAwMCIsInRpbWV6b25lX3R5cGUiOjMsInRpbWV6b25lIjoiVVRDIn0sInZlcnNpb24iOjN9LCJjb250ZXh0IjpbXX0sInJlZmVyZW5jZSI6Ik5hdGl2ZS5Mb2NhdGlvbi5FeHBpcmUiLCJ0aHJvd0F0IjoxNTU3Nzc1MjEzLCJ0aHJvd0luTWlsbGlzZWNvbmRzIjoxMDAwLCJpdGVyYXRpb25zIjo4LCJtYXhUaW1lV2FpdCI6MTAwMH0sImNvbnRleHQiOltdfX0=","DataEncoded":true}`))
}

func TestEventUnMarshal(test *testing.T) {
	RegisterTestingT(test)
	fmt.Println("Trying to marshalJSON a event entry")
	//eventMarshal, err := NewCloudEventV02(ApplicationJson, `{"errorQueue":"Error.Timer.Resource.Scheduled","retry":3,"type":"timer","referenceName":"Timer.Resource.ThrowAt","message":{"referenceName":"Timer.Resource.ThrowAt","origin":[],"data":{"eventDate":{"date":"2019-05-13 19:20:04.000000","timezone_type":3,"timezone":"UTC"},"event":{"referenceName":"Native.Location.Expire","origin":[],"data":{"eventDate":{"date":"2019-05-13 19:20:13.000000","timezone_type":3,"timezone":"UTC"},"location":{"latitude":-24.812354,"longitude":-13.251654,"velocity":null,"precision":null,"direction":null,"address":null,"creationDate":{"date":"2019-05-13 19:20:03.000000","timezone_type":3,"timezone":"UTC"},"locationDate":{"date":"2019-05-13 19:20:08.000000","timezone_type":3,"timezone":"UTC"},"timeLapse":null,"precisionQualifier":null,"reason":null,"source":"RadioGateway","rejected":false,"rejectedReason":null,"driver":null,"odometer":null,"horimetre":null,"batteryLevel":null},"user":{"userId":1,"name":"TestUser 1","active":true,"userType":{"userTypeId":1,"name":"TestUserType 1","statusSet":{"statusSetId":1,"name":"Set 1","defaultDescription":"Set 1","defaultMapImage":"\/file\/fcef71cb","inactiveMapImage":"\/file\/f2a5ce77","unknownMapImage":"\/file\/331f50e4","unknownTimeToLive":1,"hasUnknownAlarm":false,"hasInactiveAlarm":false,"unknownAlarmMessage":"","inactiveAlarmMessage":"","generateUnknownStatus":true,"statusOverflow":null,"statusSetItemCollection":[{"statusSetItemId":1,"code":32768,"description":"Status 0","image":"\/file\/3be52bd8","timeToLive":null,"hasAlarm":false,"alarmMessage":null,"statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":2,"code":32769,"description":"Status 1","image":"\/file\/3c246e41","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":1,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":3,"code":32770,"description":"Status 2","image":"\/file\/3e32ef25","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":2,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":4,"code":32771,"description":"Status 3","image":"\/file\/3fa4b22c","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":3,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":5,"code":32772,"description":"Status 4","image":"\/file\/4aacc9df","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":4,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":6,"code":32773,"description":"Status 5","image":"\/file\/4af0a333","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":5,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":7,"code":32774,"description":"Status 6","image":"\/file\/4c6e8bdb","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":8,"code":32775,"description":"Status 7","image":"\/file\/4d6d0de8","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":9,"code":32776,"description":"Status 8","image":"\/file\/4f82ae0c","timeToLive":1,"hasAlarm":false,"alarmMessage":null,"statusOverflow":8,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":20,"code":32777,"description":"Status 9","image":"\/file\/8c28de6c","timeToLive":null,"hasAlarm":true,"alarmMessage":"5000","statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":21,"code":32778,"description":"Status 10","image":"\/file\/8c35deeb","timeToLive":null,"hasAlarm":false,"alarmMessage":"5000","statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":22,"code":32779,"description":"Status 11","image":"\/file\/10c1f975","timeToLive":null,"hasAlarm":true,"alarmMessage":"","statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":23,"code":32780,"description":"Status 12","image":"\/file\/13efb338","timeToLive":null,"hasAlarm":true,"alarmMessage":"g76y7u","statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":24,"code":32781,"description":"Status 13","image":"\/file\/28b65af2","timeToLive":null,"hasAlarm":false,"alarmMessage":"","statusOverflow":null,"generateSameStatus":true,"hasEvent":false},{"statusSetItemId":25,"code":32782,"description":"Status 14","image":"\/file\/28deb28b","timeToLive":null,"hasAlarm":false,"alarmMessage":"g76y7u","statusOverflow":null,"generateSameStatus":true,"hasEvent":true}]}},"observation":""},"device":{"deviceId":"5000","deviceUniqueId":8,"system":{"systemId":2,"description":"SystemTest","code":"724-1121","systemType":{"systemTypeId":2,"description":"SystemTypeTest","code":"Tetra"}}},"contract":{"contractId":1,"contractCode":"0000\/0000","contractEmail":"test@email.com","enterprise":{"enterpriseId":1,"enterpriseDescription":"Tester Enterprise","enterpriseCode":"000000","enterpriseIdentification":"00000000000000"}},"expirationDate":{"date":"2019-05-13 19:20:13.000000","timezone_type":3,"timezone":"UTC"},"version":3},"context":[]},"reference":"Native.Location.Expire","throwAt":1557775213,"throwInMilliseconds":1000,"iterations":8,"maxTimeWait":1000},"context":[]}}`, map[string]interface{}{"DestPath": "teste"})
	//data, err := json.Marshal(eventMarshal)
	//Expect(err).ShouldNot(HaveOccurred())
	fmt.Println("Trying to UnmarshalJSON a event entry")
	//eventUnMarshal := NewEmptyEventV02()
	//err = json.Unmarshal([]byte(data), eventUnMarshal)
	//Expect(err).ShouldNot(HaveOccurred())
	//fmt.Println(eventUnMarshal.String())
	//Expect(eventMarshal.String()).Should(BeEquivalentTo(eventUnMarshal.String()))
}
